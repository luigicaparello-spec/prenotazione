<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prenotazioni — Casa Luigi</title>

  <!-- PayPal SDK -->
  <script 
    src="https://www.paypal.com/sdk/js?client-id=BAAGX03WrER82CZMeusOaNKvKygI5SwJHKBd25j46YqkC9KPDP6fXuWXAza2Ew9yLFpGPw66DgOQskwMjs&components=hosted-buttons&disable-funding=venmo&currency=EUR">
  </script>

  <!-- Google Translate -->
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

  <style>
    :root{
      --bg: linear-gradient(135deg,#f7f9fc,#e3eeff);
      --card: #fff;
      --muted:#666;
      --accent:#0078D4;
      --success:#25D366;
      --radius:12px;
      --maxw:460px;
    }
    html,body{height:100%;margin:0;}
    body{
      font-family: Inter, Arial, sans-serif;
      background: var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:30px;
    }

    .page {
      width:100%;
      max-width:var(--maxw);
      position: relative;
    }

    /* Translator */
    #google_translate_element {
      position: absolute;
      top: -40px;
      right: 0;
      z-index: 10;
      transform: scale(0.9);
      transform-origin: top right;
    }

    .card {
      background:var(--card);
      border-radius:16px;
      padding:20px;
      box-shadow:0 6px 20px rgba(0,0,0,0.08);
      overflow:hidden;
    }

    /* slider */
    .slider { width:100%; height:240px; border-radius:var(--radius); overflow:hidden; margin-bottom:12px; }
    .slides { display:flex; width:100%; height:100%; transition:transform .9s ease; }
    .slide { width:100%; height:100%; object-fit:cover; flex-shrink:0; }

    .dots { display:flex; justify-content:center; gap:8px; margin:10px 0 14px 0; }
    .dot { width:10px; height:10px; border-radius:50%; background:#d0d0d0; cursor:pointer; transition:all .2s; }
    .dot.active { background:var(--accent); transform:scale(1.1); }

    h1 { font-size:1.3rem; margin:8px 0 4px; color:#111; text-align:center; }
    p.lead { margin:0 0 12px; color:var(--muted); font-size:0.95rem; text-align:center; }

    label.small{ font-size:0.85rem; color:#333; display:block; margin-top:8px; font-weight:600; text-align:left; }

    .row { display:flex; gap:10px; }
    .col { flex:1; }

    input[type="date"], select {
      width:100%;
      padding:10px;
      border-radius:8px;
      border:1px solid #d6d6d6;
      font-size:0.95rem;
      box-sizing:border-box;
    }

    .controls { margin-top:12px; }

    .pricing {
      margin-top:14px;
      background:linear-gradient(180deg,#fbfdff,#f3f8ff);
      border-radius:10px;
      padding:12px;
      text-align:left;
      color:#123;
    }

    .pricing .row-item { display:flex; justify-content:space-between; margin:6px 0; font-size:0.95rem; }
    .pricing .muted { color:var(--muted); font-size:0.85rem; }

    .summary {
      margin-top:12px;
      padding:10px;
      border-radius:8px;
      background:#fff;
      border:1px solid #eef4ff;
    }

    .total { font-weight:700; font-size:1.05rem; color:#111; }

    .buttons { margin-top:14px; display:flex; flex-direction:column; gap:10px; }
    .btn {
      display:inline-block;
      padding:12px;
      border-radius:10px;
      color:#fff;
      text-decoration:none;
      text-align:center;
      font-weight:600;
    }
    .btn.whatsapp { background:var(--success); }
    .btn.email { background:var(--accent); }

    .paypal-container { margin-top:10px; }

    .note {
      margin-top:10px;
      font-size:0.85rem;
      color:var(--muted);
      line-height:1.3;
    }

    footer {
      margin-top:8px;
      text-align:center;
      font-size:0.85rem;
      color:var(--muted);
    }

    @media (max-width:480px){
      body{ padding:10px; }
      .slider{ height:180px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div id="google_translate_element"></div>

    <div class="card">
      <div class="slider" id="slider">
        <div class="slides" id="slides">
          <img class="slide" src="foto1.webp" alt="Casa Luigi 1">
          <img class="slide" src="foto2.avif" alt="Casa Luigi 2">
          <img class="slide" src="foto3.avif" alt="Casa Luigi 3">
          <img class="slide" src="foto4.avif" alt="Casa Luigi 4">
        </div>
      </div>
      <div class="dots" id="dots"></div>

      <h1>Prenota il tuo soggiorno</h1>
      <p class="lead">Controlla le date, scegli il numero di ospiti e visualizza il prezzo stimato. Minimo 2 notti.</p>

      <div class="controls">
        <label class="small" for="checkin">Check-in</label>
        <input id="checkin" type="date" />
        <label class="small" for="checkout">Check-out</label>
        <input id="checkout" type="date" />
        <label class="small" for="guests">Ospiti</label>
        <select id="guests">
          <option value="1">1 persona</option>
          <option value="2">2 persone</option>
          <option value="3">3 persone</option>
          <option value="4">4 persone</option>
        </select>
      </div>

      <div class="pricing">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div style="font-weight:700">Tariffe stagionali (per notte)</div>
          <div class="muted" style="font-size:0.85rem">Prezzi per persona</div>
        </div>

        <div class="row-item"><div>1 persona</div><div><strong>€75</strong></div></div>
        <div class="row-item"><div>2 persone</div><div><strong>€87</strong></div></div>
        <div class="row-item"><div>3–4 persone</div><div><strong>€110</strong></div></div>

        <hr style="border:none;border-top:1px dashed #e2e8f0;margin:10px 0">

        <div class="muted">
          • Soggiorno minimo: <strong>2 notti</strong>.<br>
          • Sconto <strong>13%</strong> per soggiorni ≥ 7 notti.<br>
          • Sconto <strong>43%</strong> per soggiorni ≥ 30 notti.<br><br>
          Per affitti superiori a un mese è richiesto un contratto conforme alle tabelle del canone concordato.
        </div>
      </div>

      <div class="summary" id="summary">
        <div style="display:flex;justify-content:space-between"><div class="muted">Notti</div><div id="nights">–</div></div>
        <div style="display:flex;justify-content:space-between"><div class="muted">Tariffa per notte</div><div id="nightRate">–</div></div>
        <div style="display:flex;justify-content:space-between"><div class="muted">Sconto applicato</div><div id="discount">–</div></div>
        <div style="display:flex;justify-content:space-between; margin-top:8px;"><div class="muted">Totale stimato</div><div class="total" id="total">–</div></div>
      </div>

      <div class="buttons">
        <a id="whatsappBtn" class="btn whatsapp" target="_blank" href="#">Contattami su WhatsApp</a>
        <a id="emailBtn" class="btn email" target="_blank" href="#">Invia richiesta via Email</a>
        <div class="paypal-container" id="paypal-container-KNC739BU5PTYJ"></div>
      </div>

      <p class="note">
        <strong>Nota:</strong> per soggiorni superiori a un mese verrà richiesto un contratto dedicato; il prezzo finale potrà variare in base alla durata e ai requisiti.
      </p>

      <footer>
        © 2025 Casa Luigi — <a href="https://maps.app.goo.gl/8UjpskqT4CEAgex68" target="_blank">Visualizza su Google Maps</a>
      </footer>
    </div>
  </div>

  <script>
    // GOOGLE TRANSLATE INIT
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'it',
        includedLanguages: 'en,fr,de,es,pt,ru,ja,zh-CN',
        layout: google.translate.TranslateElement.InlineLayout.HORIZONTAL
      }, 'google_translate_element');
    }

    // PAYPAL hosted button
    if (window.paypal && paypal.HostedButtons) {
      try {
        paypal.HostedButtons({ hostedButtonId: "KNC739BU5PTYJ" }).render("#paypal-container-KNC739BU5PTYJ");
      } catch(e){ console.warn('PayPal render error', e); }
    }

    // Prezzi e logica
    const rates = { 1: 75, 2: 87, "3-4": 110 };
    const discount7 = 0.13, discount30 = 0.43, minNights = 2;

    const checkin = document.getElementById('checkin');
    const checkout = document.getElementById('checkout');
    const guests = document.getElementById('guests');
    const nightsEl = document.getElementById('nights');
    const nightRateEl = document.getElementById('nightRate');
    const discountEl = document.getElementById('discount');
    const totalEl = document.getElementById('total');
    const whatsappBtn = document.getElementById('whatsappBtn');
    const emailBtn = document.getElementById('emailBtn');

    const today = new Date().toISOString().split('T')[0];
    checkin.min = today; checkout.min = today;

    function parseDate(s){ return s ? new Date(s + 'T00:00:00') : null; }
    function daysBetween(a,b){ return (!a||!b)?0:Math.round((b - a)/(1000*60*60*24)); }
    function getRate(g){ return g==1?rates[1]:g==2?rates[2]:rates["3-4"]; }

    function compute(){
      const a=parseDate(checkin.value), b=parseDate(checkout.value), g=parseInt(guests.value);
      if(!a||!b||b<=a){ nightsEl.textContent='–'; nightRateEl.textContent='–'; discountEl.textContent='–'; totalEl.textContent='–'; return;}
      const nights=daysBetween(a,b); const rate=getRate(g);
      const subtotal=rate*nights;
      let d=0; if(nights>=30)d=discount30; else if(nights>=7)d=discount7;
      const disc=subtotal*d, total=subtotal-disc;
      nightsEl.textContent=nights;
      nightRateEl.textContent=`€${rate.toFixed(2)}`;
      discountEl.textContent=d?`${(d*100).toFixed(0)}% (-€${disc.toFixed(2)})`:'Nessuno';
      totalEl.textContent=`€${total.toFixed(2)}`;
      const fmt=d=>d?d.split('-').reverse().join('/'):'';
      const msg=`Ciao Luigi, vorrei prenotare dal ${fmt(checkin.value)} al ${fmt(checkout.value)} per ${g} persona/e. Totale stimato: €${total.toFixed(2)}. È disponibile?`;
      const phone='393382661198';
      whatsappBtn.href=`https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
      emailBtn.href=`mailto:luigi.caparello@gmail.com?subject=Richiesta prenotazione&body=${encodeURIComponent(msg)}`;
    }

    [checkin, checkout, guests].forEach(el => el.addEventListener('change', compute));

    // Slider
    (function(){
      const slides=document.getElementById('slides');
      const imgs=document.querySelectorAll('.slide');
      const dotsC=document.getElementById('dots');
      let i=0, t;
      imgs.forEach((_,idx)=>{
        const d=document.createElement('div');
        d.className='dot'+(idx===0?' active':'');
        d.addEventListener('click',()=>{i=idx;show();reset();});
        dotsC.appendChild(d);
      });
      const dots=document.querySelectorAll('.dot');
      const show=()=>{slides.style.transform=`translateX(-${i*100}%)`;dots.forEach((e,k)=>e.classList.toggle('active',k===i));};
      const next=()=>{i=(i+1)%imgs.length;show();};
      const start=()=>{t=setInterval(next,3500);};
      const reset=()=>{clearInterval(t);start();};
      start();
    })();
  </script>
</body>
</html>
